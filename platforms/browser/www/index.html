<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
	<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
    <!-- <link rel="stylesheet" type="text/css" href="css/index.css" /> -->
    <title>Go-Obat</title>

	
    <!-- styles -->
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/owl.carousel.css" rel="stylesheet">
    <link href="css/owl.theme.css" rel="stylesheet">

    <!-- theme stylesheet -->
    <link href="css/style.default.css" rel="stylesheet" id="theme-stylesheet">

    <!-- your stylesheet with modifications -->
    <link href="css/custom.css" rel="stylesheet">

    <script src="js/js/respond.min.js"></script>

    <link rel="shortcut icon" href="icon.png">
</head>

<body>

    <div id="top">
		
    </div>
    <div class="navbar navbar-default yamm" role="navigation" id="navbar">
        
    </div>

    <div id="all">
        <!-- <div class="row text-center" id='Detailproductsname'> -->
        <!-- </div> -->
		<div class="well well-sm">
			<strong>10 Produk</strong>
			<div class="btn-group">
				<a href="#" id="list" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-th-list">
				</span>List</a> <a href="#" id="grid" class="btn btn-default btn-sm"><span
					class="glyphicon glyphicon-th"></span>Grid</a>
			</div>
		</div>
		
		<div id="Detailproductsname" class="row list-group">
		</div>

    </div>

</body>

</html>
<script src="js/js/jquery-1.11.0.min.js"></script>
<script src="js/form.js"></script>
<script src="js/array.js"></script>
<script src="js/jquery.js"></script>
<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>
<script src="js/md5.min.js"></script>
<script src="controller/auth.js"></script>

<script src="js/webservice.js"></script>
<script type="text/javascript">
	$('#list').click(function(event){event.preventDefault();$('#Detailproductsname .item').addClass('list-group-item');});
    $('#grid').click(function(event){event.preventDefault();$('#Detailproductsname .item').removeClass('list-group-item');$('#Detailproductsname .item').addClass('grid-group-item');});

	webService.initialize();
	var idCustomer = localStorage.getItem('idCustomer');
	if (idCustomer != null){
		var promise1 = webService.readPromiseXml('countries',111);
		 
		var filterArray1 = ['id_customer',idCustomer];
		var promise2 = webService.readPromiseXml('carts',webService.filterGenerator(filterArray1));
		promise2.success(function(data){
			var carts = webService.searchPromise(data);
			var idCart = carts[carts.length-1];
			localStorage.setItem('idCart',idCart);
			
			if (idCart == 'undefined'){	
				idCart
			}else if(idCart == 0){
				idCart
			}else if(idCart == 'null'){
				idCart
			}else{
				var promise3 = webService.readPromiseXml('carts',idCart);
				promise3.success(function(data){
					var cart = $(data).children().children()[0].children[19].children[0].children;
					console.log(cart);	
					$.each(cart, function(key, value) {
						hasil = new Array();
						hasil[key] = value;
						localStorage.setItem('cartRow_'+key,hasil[''+key+''].children[key].textContent);
						console.log(localStorage.getItem('cartRow_'+key));	
					});		
					localStorage.setItem('cartsLength',cart.length);
					$('#navbar').load("view/templates/navbar.html");
				});
			}
		});
		
	}
	
	var filterArray2 = ['active',1];	
	var promise4 = webService.readPromiseXml('products',webService.filterGenerator(filterArray2));
	promise4.success(function(data){
	var idProducts = webService.searchPromise(data);
		for(var i=0;i<10;i++){
			var promise5 = webService.readPromiseJson('products',idProducts[i]);
			promise5.success(function(data){
			console.log(data);
				var Detailproductsname ='';
				var Detailproductsnamecategori ='';
				var apiIdProduct = data["product"]["id"];
				var apiIdSupplier = data["product"]["id_supplier"];
				var apiIdImage = data["product"]["associations"]["images"][0]["id"];
				var div1 ='<div class="item  col-xs-6 col-md-3">';
				var div2 ='<div class="thumbnail">';
				var setUrlImageProduts = urlapi+"images/products/"+apiIdProduct+"/"+apiIdImage+"/medium_default?ws_key="+key;
				var imgSrc = '<img style="width:10em; height:10em;"src="'+setUrlImageProduts+'" alt="">';
				var classCaption ='<div class="caption">';
				var contentCaption ='<span style="font-weight:bold" class="group inner list-group-item-heading">'+data["product"]["name"]+'</span>';
				var contentCaptionDescription ='<p class="group inner list-group-item-text">Product description.</p>';
				var div3 ='<div class="row">';
				var div31 ='<div class="col-xs-12 col-md-6">';
				var contentDiv31 ='<p class="lead">$21.000</p>';
				var endDiv31 ='</div>';
				var div4 ='<div class="col-xs-12 col-md-6">';
				var contentDiv4 ='<a class="btn btn-success" href="view/orders/index.html?id='+apiIdProduct+'">Beli</a>';
				var endDiv4 ='</div></div></div></div></div></div>';
				
				 
				 alls = div1+div2+imgSrc+classCaption+contentCaption+contentCaptionDescription+div3+div31+contentDiv31+endDiv31+div4+contentDiv4+endDiv4;

				$("#Detailproductsname").append(alls);
				//$('#categories').append(Detailproductsnamecategori);
			});
		}	
	});

	$('#navbar').load("view/templates/navbar.html");
	$('#top').load("view/templates/top.html");
	$("#carts").click(function(){
		alert("The paragraph was clicked.");
	});
	$.ajaxSetup({ cache: true });
	console.timeEnd(promise4);
</script>