<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
	<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
    <!-- <link rel="stylesheet" type="text/css" href="css/index.css" /> -->
    <title>Go-Obat</title>

	
    <!-- styles -->
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/owl.carousel.css" rel="stylesheet">
    <link href="css/owl.theme.css" rel="stylesheet">

    <!-- theme stylesheet -->
    <link href="css/style.default.css" rel="stylesheet" id="theme-stylesheet">

    <!-- your stylesheet with modifications -->
    <link href="css/custom.css" rel="stylesheet">

    <script src="js/js/respond.min.js"></script>

    <link rel="shortcut icon" href="icon.png">
</head>

<body>

    <div id="top">
		
    </div>
    <div class="navbar navbar-default yamm" role="navigation" id="navbar">
        
    </div>

    <div id="all">
        <div class="row text-center" id='Detailproductsname'>
        </div>
    </div>

</body>

</html>
<script src="js/js/jquery-1.11.0.min.js"></script>
<script src="js/form.js"></script>
<script src="js/array.js"></script>
<script src="js/jquery.js"></script>
<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>
<script src="js/md5.min.js"></script>
<script src="controller/auth.js"></script>

<script src="js/webservice.js"></script>
<script type="text/javascript">

	webService.initialize();
	var idCustomer = localStorage.getItem('idCustomer');

	if (idCustomer != null){
	
		/*
		var a = webService.readId('countries',111);
		localStorage.setItem('countries',$(a)["0"].children["0"].children["0"].children["11"].children["0"].textContent);
		localStorage.setItem('idCountries',$(a)["0"].children["0"].children["0"].children["0"].textContent);
		*/
		var promise1 = webService.readPromiseXml('countries',111);
		promise1.success(function(data){
			localStorage.setItem('countries',$(data)["0"].children["0"].children["0"].children["11"].children["0"].textContent);
			localStorage.setItem('idCountries',$(data)["0"].children["0"].children["0"].children["0"].textContent);
		});
		var filterArray1 = ['id_customer',idCustomer];
		var promise2 = webService.readPromiseXml('carts',webService.filterGenerator(filterArray1));
		promise2.success(function(data){
			var carts = webService.searchPromise(data);
			var idCart = carts[carts.length-1];
			console.log(idCart);
			if (idCart == 'undefined'){	
				idCart
			}else if(idCart == 0){
				idCart
			}else if(idCart == 'null'){
				idCart
			}else{
				console.log('ini idCart'+idCart);
				/*
				var getCart = webService.readId('carts',idCart);
				var cart = $(getCart).children().children()[0].children[19].children[0].children;
					$.each(cart, function(key, value) {
						hasil = new Array();
						hasil[key] = value;
						localStorage.setItem('cartRow_'+key,hasil[''+key+''].children[key].textContent);
					});
				*/
				var promise3 = webService.readPromiseXml('carts',idCart);
				promise3.success(function(data){
					var cart = $(data).children().children()[0].children[19].children[0].children;
					$.each(cart, function(key, value) {
						hasil = new Array();
						hasil[key] = value;
						localStorage.setItem('cartRow_'+key,hasil[''+key+''].children[key].textContent);
					});
				
				
					localStorage.setItem('cartsLength',cart.length);
					console.log(localStorage.getItem('cartsLength'));	
				});
			}
		});
		/*
		var filterArray = ['id_customer',idCustomer];
		var carts = webService.search('carts', filterArray);
	
		var idCart = carts[carts.length-1];
	
		if (idCart == 'undefined'){	
			idCart
		}else if(idCart == 0){
			idCart
		}else if(idCart == 'null'){
			idCart
		}else{
			console.log('ini idCart'+idCart);
			var getCart = webService.readId('carts',idCart);
			var cart = $(getCart).children().children()[0].children[19].children[0].children;
				$.each(cart, function(key, value) {
					hasil = new Array();
					hasil[key] = value;
					localStorage.setItem('cartRow_'+key,hasil[''+key+''].children[key].textContent);
				});

			
			localStorage.setItem('cartsLength',cart.length);
			console.log(localStorage.getItem('cartsLength'));	
		}
		*/
		
		
	}
		var filterArray2 = ['active',1];	
		var promise4 = webService.readPromiseXml('products',webService.filterGenerator(filterArray2));
		promise4.success(function(data){
		var idProducts = webService.searchPromise(data);
		for(var i=0;i<10;i++){
			var promise5 = webService.readPromiseJson('products',idProducts[i]);
			promise5.success(function(data){
				var Detailproductsname ='';
				var Detailproductsnamecategori ='';
				var apiIdProduct = data["product"]["id"];
				var apiIdSupplier = data["product"]["id_supplier"];
				var apiIdImage = data["product"]["associations"]["images"][0]["id"];
				var setUrlImageProduts = urlapi+"images/products/"+apiIdProduct+"/"+apiIdImage+"/small_default?ws_key="+key;
				var div1 ='<div class="col-xs-6 col-md-3">';
				var thumbnail ='<div class="thumbnail">';
				var imgSrc = '<img style="width:10em; height:10em;"src="'+setUrlImageProduts+'" alt="">';
				var classCaption ='<div class="caption">'+ apiIdProduct;
				var p1 = '<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>';
				var p2 = '<p><a href="view/orders/index.html?id='+apiIdProduct+'&id_supplier='+apiIdSupplier+'&idCustomer='+idCustomer+'" class="btn btn-primary" id="carts" >Beli</a><button  id="detailProduct" class="btn btn-default">Detail</button></p>';
				var divEnd1 ='</div></div></div>';
				var alls = div1+thumbnail+imgSrc+classCaption+p1+p2+divEnd1;
				//Detailproductsnamecategori += ' id kategori = '+ apiIdCategory +'';
				$("#Detailproductsname").append(alls);
				//$('#categories').append(Detailproductsnamecategori);
			});
		}
		
	});
	/*
	var filterArray = ['active',1];
	var idProducts = webService.search('products',filterArray);
	var objectName = 'products';
	for(i=0;i<10;i++){
		var setURL = urlapi + objectName + "/" + idProducts[i] + '?output_format=JSON';	
		$.getJSON(setURL, 
			function(setUrlProduct){
				var Detailproductsname ='';
				var Detailproductsnamecategori ='';
				var apiIdProduct = setUrlProduct["product"]["id"];
				var apiIdSupplier = setUrlProduct["product"]["id_supplier"];
				var apiIdImage = setUrlProduct["product"]["associations"]["images"][0]["id"];
				var setUrlImageProduts = urlapi+"images/products/"+apiIdProduct+"/"+apiIdImage+"/small_default?ws_key="+key;
				var div1 ='<div class="col-xs-6 col-md-3">';
				var thumbnail ='<div class="thumbnail">';
				var imgSrc = '<img style="width:10em; height:10em;"src="'+setUrlImageProduts+'" alt="">';
				var classCaption ='<div class="caption">'+ apiIdProduct;
				var p1 = '<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>';
				var p2 = '<p><a href="view/orders/index.html?id='+apiIdProduct+'&id_supplier='+apiIdSupplier+'&idCustomer='+idCustomer+'" class="btn btn-primary" id="carts" >Beli</a><button  id="detailProduct" class="btn btn-default">Detail</button></p>';
				var divEnd1 ='</div></div></div>';
				var alls = div1+thumbnail+imgSrc+classCaption+p1+p2+divEnd1;
				//Detailproductsnamecategori += ' id kategori = '+ apiIdCategory +'';
				$("#Detailproductsname").append(alls);
				//$('#categories').append(Detailproductsnamecategori);
			}
		);
	}
	*/
	$('#navbar').load("view/templates/navbar.html");
	$('#top').load("view/templates/top.html");
	
	
	
	
	$("#carts").click(function(){
		alert("The paragraph was clicked.");
	});
	$.ajaxSetup({ cache: true });
</script>